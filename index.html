<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
  </head>
  <script>
  function submit() {
  function $(obj) {
    return document.getElementById(obj)
  }
  var c = $('canvas')
  var t = $('textbox')
  var fsize = $('fsize').value
  var lnumber = $('lnumber').value
  var lwidth = $('lwidth').value
  var lines = t.value.split('\n')
  var colomns = $('twidth').value
  c.width = (colomns + 1) * fsize
  c.height = (lines.length + 3) * fsize
  var ctx = c.getContext('2d')
  ctx.clearRect(0, 0, canvas.width, canvas.height)
  ctx.beginPath()
  ctx.font = fsize + 'px Microsoft YaHei'
  ctx.lineWidth = lwidth
  /* Split string
  for (i = 0; i < lines.length; i++) {
    if (lines[i].length > colomns) {
      for (j = 0; j < lines[i].length / colomns; j++) {
        lines.splice(i + j, 0, lines[i].slice(j * colomns, j * (colomns + 1)))
      }
    }
  }
  */
  for (i = 0; i < lines.length; i++) {
    ctx.fillText(lines[i], 0, fsize * (i + 1))
    for (j = 0; j < lnumber; j++) {
      ctx.moveTo(0, fsize * ((j + Math.random() + 1) / lines.length + i))
      ctx.quadraticCurveTo(
        ((1 + Math.random()) / 3) * colomns * fsize,
        fsize * (i + (j + Math.random() + 1) / lines.length),
        colomns * fsize,
        fsize * ((j + Math.random() + 1) / lines.length + i)
      )
      ctx.stroke()
    }
  }
}
  </script>
  <body>
    <p>
      <textarea id="textbox" wrap="hard" placeholder="请输入文字"></textarea>
    </p>
    <p><label>字号</label><input type="text" value="20" id="fsize" /></p>
    <p><label>每行字数</label><input type="text" value="20" id="twidth" /></p>
    <p>
      <label>颜色</label> <input type="color" id="textcolor" value="#000000" />
    </p>

    <p>
      <label>每行干扰线条数</label> <input type="text" id="lnumber" value="2" />
    </p>

    <p>
      <label>干扰线宽度</label> <input type="text" id="lwidth" value="0.3" />
    </p>
    <p><button type="button" onclick="submit()">生成</button></p>
    <canvas id="canvas"></canvas>
  </body>
</html>
